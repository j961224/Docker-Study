# 가상머신과 Docker

## 1. Docker
: 오픈 소스 컨테이너 프로젝트

- 서버에 여러 개의 컨테이너(이미지)를 실행하며 이미지 저장과 배포를 한다.

### Immutable Infrastructure

: 호스트 OS와 서비스 운영 환경을 분리하고 한 번 설정한 운영 환경은 변경하지 않는다.

=> 서비스 운영 환경 이미지를 한 번 쓰고 버린다.

- Immutable Infrastructure 장점

 1. **편리한 관리**: 이미지 자체만 관리하면 되며, 이미지 생성 설정도 파일로 되어 있어 버전 관리 시스템을 활용 가능
 2. **확장**: 이미지 하나로 서버를 계속 찍어낼 수 있다.
 3. **테스트**: 개발자 PC나 테스트 서버에서 이미지 실행 시, 서비스 운영 환경과 동일한 환경이 구성된다.
 4. **가볍다**: 운영체제와 서비스 운영 환경을 분리해 가볍고 어디든 실행 가능한 환경을 제공한다.


### 가상 머신

: 편하기 하지만 성능이 좋지 못하다.

=> 가상 머신은 리얼 머신에 비해 속도가 느리며 전가상화의 느린 속도를 개선하기 위해 반가상화 방식이 개발되었다.

=> 가상 머신은 이미지를 생성하고 실행하는 기능만 있고 배포, 관리 능력이 떨어진다.

### Docker

: 반가상화보다 좀 더 경량화된 방식으로 프로그램과 라이브러리만 격리해서 설치 가능하고 OS 자원은 호스트와 공유한다.

- 이러한 기능으로 이미지 용량이 크게 줄었다.
- 이미지 생성과 배포에 특화된 기능 제공
- 이미지 버전 관리 기능 제공

![이미지1](https://user-images.githubusercontent.com/59636424/126587351-f37ac1e8-c2ba-4e0a-9017-5e4ec77fea9a.png)

:위의 사진에서 볼 수 있듯이, Docker는 가상화하는 계층이 없으므로 메모리 접근, 파일시스템, 네트워크 속도가 가상 머신에 비해 월등히 빠르다.

### 리눅스 컨테이너
: LCX라는 시스템 레벨 가상화를 제공

* LCX: 리눅스 커널 레벨에서 제공하는 일종의 격리된 가상 공간

=> **그러나 격리된 공간만 제공할 뿐 개발 및 서버 운영에 필요한 부가 기능 부족!**

=> 도커는 리눅스 커널의 cgroups와 namespaces를 기반으로 하여 이미지, 컨테이너 생성 및 관리 기능과 다양한 부가 기능 제공


## 2. Docker 이미지와 컨테이너

- 베이스 이미지: 리눅스 배포판의 유저랜드만 설치된 파일을 뜻함.

- 유저랜드: 커널 공간과 유저 공간으로 나누며 유저 공간에서 실행되는 실행 파일과 라이브러리를 유저랜드라고 한다.


### Docker 이미지
: 베이스 이미지에서 바뀐 부분만 이미지로 생성하고 실행할 때는 베이스 이미지와 바뀐 부분을 합쳐 실행

-> Docker 이미지는 파일이므로 저장소에 올린 뒤 다른 곳에서 받을 수 있다.

### Docker 컨테이너
: 이미지를 실행한 상태이다.

- 이미지는 **실행 파일**이고 컨테이너는 **프로세스**이다.

- Docker는 특정 실행 파일 또는 스크립트를 위한 실행 환경이라 보면 된다.
- 시스템 구조가 단순해지고 명확해지는 장점이 있지만 의존성 관계를 해결하기가 어려워지는 단점이 있다.

* 위의 단점을 해결하기 위해, 서버 구성을 미리 해놓은 Docker 이미지를 사용하면 실행할 서버가 몇 개가 되든 손쉽게 해결 가능!
